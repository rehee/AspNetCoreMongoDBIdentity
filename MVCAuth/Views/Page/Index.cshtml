@model SDHCC.DB.Content.ContentPostModel
@{
  ViewData["Title"] = "Index";
  var list = (List<Type>)ViewBag.allowChildrenType;
}
<h2>Bread Crumb</h2>
@{
  await Html.RenderPartialAsync("Contents/_BreadCrumb", Model != null ? Model.Id : "");
}

<h2>Index</h2>
Create Page
@foreach (var item in list)
{
  using (Html.BeginForm("PreCreate", "Page", FormMethod.Post, new { @id = "pre_create_" + list.IndexOf(item).ToString() }))
  {
    @Html.Hidden("fullName", item.FullName + "," + item.Assembly)
    <a onclick="preRequest('pre_create_@list.IndexOf(item).ToString()')">@item.Name</a>
  }
}

<h2>content</h2>
@{
  await Html.RenderPartialAsync("Contents/_CurrentLevel", Model != null ? Model.Id : "");
}

@if (Model != null)
{
  <h2>Edit</h2>

  <div class="row">
    <div class="col-md-4">
      @using (Html.BeginForm("Save", "Page", FormMethod.Post, new { @enctype = "multipart/form-data" }))
      {
        @Html.HiddenFor(b => b.Id)
        @Html.HiddenFor(b => b.ParentId)
        @Html.HiddenFor(b => b.FullType)
        @Html.HiddenFor(b => b.AssemblyName)
        var index = 0;
        @foreach (var item in Model.Properties)
        {
          await Html.RenderPartialAsync("AdminInputs/_AdminInput", new ContentPropertyIndex(item, index));
          index++;
        }
        <input type="submit" value="submit" />
      }

    </div>
  </div>


}


<script>
  function preRequest(id) {
    var form = document.getElementById(id);
    form.submit();
  }
</script>
